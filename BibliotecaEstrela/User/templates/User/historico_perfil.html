{% extends 'base.html' %}
{% load static %}

{% block content %}
    <style>
        select{
            padding: 5px 0;

            border-radius: 6px;
        }

        .custom-select {
            appearance: none; /* remove o estilo nativo */
            -webkit-appearance: none;
            -moz-appearance: none;

            width: 100%;
            padding: 8px 35px 8px 10px; /* espaço extra pra seta */
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 6px;
            background-color: #ffffff;

            /* adiciona uma seta personalizada */
            background-image: url("data:image/svg+xml;utf8,<svg fill='gray' height='10' viewBox='0 0 20 20' width='10' xmlns='http://www.w3.org/2000/svg'><path d='M5 7l5 5 5-5z'/></svg>");
            background-repeat: no-repeat;
            background-position: right 10px center;
            background-size: 12px;
            }

            .custom-select:focus {
            outline: none;
            border-color: #999999;
            box-shadow: 0 0 3px #3b80ff50;
            }

        .solicitar-extensao-btn{
            font-size: 17px;
            padding: 5px 0;
            font-weight: 500;
    
            color: #0D074490;
    
            background-color: #3B80FF37;

            border: none;
            border-radius: 6px;
        }
    </style>

    <main class="text-center" style="padding: 0 10%">
        <div class="d-flex gap-5 flex-column">
            <div class="card-perfil editar-perfil d-flex align-items-start flex-column gap-1 py-4 px-5">
                <h2>Livros em reserva</h2>

                <div class="d-flex flex-row w-100 gap-4">
                    {% for reserva in reservas %}

                    <div class="card-livros col-12 col-md-6 col-lg-3 mb-4">
                        <div class="card h-100 book-item shadow-sm">
                            {% if not reserva.id_livro.imagem %}
                                <img src="https://via.placeholder.com/300x450?text=Sem+Capa" class="card-img-top" style="height: 300px; object-fit: cover;" alt="Sem capa">
                            {% else %}
                            <div>
                                <img src="{{ reserva.id_livro.imagem.url }}" class="card-img-top" style="height: 300px; object-fit: cover;" alt="{{ livro.nome }}">
                            </div>
                            {% endif %}
                            <div class="card-body d-flex flex-column text-center">
                                <h6 class="card-title fw-bold">{{ reserva.id_livro.nome }}</h6>
                                <p class="card-text text-muted small mt-auto">{{ reserva.id_livro.autor }}</p>
                                {{ reserva.data_reserva }}
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

            </div>

            <div class="card-perfil editar-perfil d-flex align-items-start flex-column gap-1 py-4 px-5">
                <h2>Livros em emprestimo</h2>

                <div class="d-flex flex-row w-100 gap-4">
                    {% for emprestimo in emprestimos %}
                        <div class="card-livros col-12 col-md-6 col-lg-3 mb-4">
                            <div class="card h-100 book-item shadow-sm">
                                {% if not emprestimo.id_livro.imagem %}
                                    <img src="https://via.placeholder.com/300x450?text=Sem+Capa" class="card-img-top" style="height: 300px; object-fit: cover;" alt="Sem capa">
                                {% else %}
                                <div>
                                    <img src="{{ emprestimo.id_livro.imagem.url }}" class="card-img-top" style="height: 300px; object-fit: cover;" alt="{{ livro.nome }}">
                                </div>
                                {% endif %}
                                <div class="card-body d-flex flex-column text-center">
                                    <h6 class="card-title fw-bold">{{ emprestimo.id_livro.nome }}</h6>
                                    <p class="card-text text-muted small mt-auto">{{ emprestimo.id_livro.autor }}</p>
                                    {{ emprestimo.data_reserva }}
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            </div>

            {% if extensoes %}
                <div class="card-perfil editar-perfil d-flex align-items-start flex-column gap-1 py-4 px-5">
                    <h2>Solicitar extensão do prazo</h2>

                    <form method="post" class="d-flex flex-column w-100">
                        {% csrf_token %}

                        <label for="livro" class="align-self-start">Selecione o livro</label>
                        <select name="livro" id="livro" class="custom-select" required>
                            <option value="">Selecione um livro</option>
                            {% for emprestimo in extensoes %}
                                <option value="{{ emprestimo.id }}" class="ultima-opcao">
                                    {{ emprestimo.id_livro.nome }}
                                </option>
                            {% endfor %}
                        </select>

                        <button type="submit" class="solicitar-extensao-btn mt-3 align-self-start w-100">Solicitar Extensão</button>
                    </form>
                </div>
            {% endif %}

        </div>
    </main>
{% endblock content %}
